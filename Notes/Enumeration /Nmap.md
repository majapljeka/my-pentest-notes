| Command | Description |
|---------|-------------|
|[Nmap Scripting Engine (NSE)](https://nmap.org/book/man-nse.html) | [Nmap Scripts](https://nmap.org/nsedoc/index.html) | 
 [Host Discovery Strategies](https://nmap.org/book/host-discovery-strategies.html) |  [Port scanning techniques](https://nmap.org/book/man-port-scanning-techniques.html)
| `nmap -v -sS -A -T4 target` | Nmap verbose scan, runs syn stealth, T4 timing, OS and service version info, traceroute and scripts against services. |
| `ping sweep sudo nmap -pn target` | Does a ping sweep over the target's network to see all the available IPs. |
| `nmap -v -sS -p– -A -T4 target` | As above but scans all TCP ports (takes a lot longer). -A 	Performs service detection, OS detection, traceroute and uses defaults scripts to scan the target. |
| `nmap -v -sU -sS -p- -A -T4 target` | As above but scans all TCP ports and UDP scan (takes even longer). |
| `nmap -v -p 445 –script=smb-check-vulns --script-args=unsafe=1 192.168.1.X` | Nmap script to scan for vulnerable SMB servers. |
| `nmap localhost` | Displays all the ports that are currently in use. |
| ` nmap -sV --open -oA nibbles_initial_scan <ip address>` | This will run a service enumeration (-sV) scan against the default top 1,000 ports and only return open ports and save in nibbles_initixyz XML output. |
| `ls /usr/share/nmap/scripts/* \| grep ftp` | Search nmap scripts for keywords. |
| `nc -nv 10.129.42.190 22` | Using nc to do some banner grabbing |
| `nmap -sC -p 22,80 -oA nibbles_script_scan 10.129.42.190` | Specify which ports |
| `sudo nmap 10.129.2.0/24 -sn -oA tnet \| grep for \| cut -d" " -f5` | Scan Network Range; -sn 	Disables port scanning. Response is based on  ICMP echo requests  |
| `sudo nmap -sn -oA tnet -iL hosts.lst \| grep for \| cut -d" " -f5` | Scan IP List ; -iL 	Performs defined scans against targets in provided 'hosts.lst' list.Response is based on  ICMP echo requests |
| `sudo nmap -sn -oA tnet 10.129.2.18 10.129.2.19 10.129.2.20 \| grep for \| cut -d" " -f5` | Scan Multiple IPs |
| `sudo nmap 10.129.2.18 -sn -oA host -PE --packet-trace` | It would send an ARP ping resulting in an ARP reply. We can confirm this with the "--packet-trace" option. Shows all packets sent and received. |
| `sudo nmap 10.129.2.18 -sn -oA host -PE --packet-trace --disable-arp-ping` | Scan our target with the desired ICMP echo requests |
| `sudo nmap 10.129.2.28 --top-ports=10` | Scanning Top 10 TCP Ports |
| `sudo nmap 10.129.2.28 -p 443 --packet-trace --disable-arp-ping -Pn -n --reason -sT ` | Connect Scan on TCP Port 443. (-sT) uses the TCP three-way handshake to determine if a specific port on a target host is open or closed. -Pn = Disables ICMP Echo requests. -n = disables DNS resolution |
| `sudo nmap 10.129.2.28 -p 139 --packet-trace -n --disable-arp-ping -Pn` | Filtered Ports |
| `sudo nmap 10.129.2.28 -F -sU` | Discovering Open UDP Ports. -F = scan top 100 ports |
| `sudo nmap 10.129.2.28 -sU -Pn -n --disable-arp-ping --packet-trace -p 137 --reason` | Scanning UDP ports --reason = Displays the reason a port is in a particular state. |
| `sudo nmap 10.129.2.28 -Pn -n --disable-arp-ping --packet-trace -p 445 --reason  -sV` | Version scan |
| `sudo nmap 10.129.2.28 -p- -oA target` | We can also specify the option (-oA) to save the results in all formats. XML format to HTML, we can use the tool xsltproc=xsltproc target.xml -o target.html |
| `sudo nmap 10.129.2.28 -p- -sV ` | Service Enumeration and banner grabing |
| `sudo nmap 10.129.2.28 -p- -sV ` | Service Enumeration and banner grabing; We can also increase the verbosity level (-v / -vv), which will show us the open ports directly when Nmap detects them. ; --stats-every=5s 	Shows the progress of the scan every 5 seconds. |
| `sudo tcpdump -i eth0 host 10.10.14.2 and 10.129.2.28` | Intercept the network traffic using tcpdump |
| `sudo nmap 10.129.2.28 -p 25 --script banner,smtp-commands` | Specifying scripts |
| ` sudo nmap 10.129.2.28 -p 80 -sV --script vuln` | Vulnerability Assessments |
| `sudo nmap 10.129.2.0/24 -F` | Default Performance Scan |
| `sudo nmap 10.129.2.0/24 -F --initial-rtt-timeout 50ms --max-rtt-timeout 100ms` | Optimized RTT; -F 	Scans top 100 ports; --initial-rtt-timeout 50ms 	Sets the specified time value as initial RTT timeout; --max-rtt-timeout 100ms 	Sets the specified time value as maximum RTT timeout. |
| `sudo nmap 10.129.2.0/24 -F \| grep "/tcp" \| wc -l` | `sudo nmap 10.129.2.0/24 -F --max-retries 0 \| grep "/tcp" \| wc -l` Another way to increase the scans' speed is to specify the retry rate of the sent packets (--max-retries). The default value for the retry rate is 10, so if Nmap does not receive a response for a port, it will not send any more packets to the port and will be skipped. |




| **State**         | **Description**                                                                                                                                                                                         |
| ----------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `open`            | This indicates that the connection to the scanned port has been established. These connections can be **TCP connections**, **UDP datagrams** as well as **SCTP associations**.                          |
| `closed`          | When the port is shown as closed, the TCP protocol indicates that the packet we received back contains an `RST` flag. This scanning method can also be used to determine if our target is alive or not. |
| `filtered`        | Nmap cannot correctly identify whether the scanned port is open or closed because either no response is returned from the target for the port or we get an error code from the target.                  |
| `unfiltered`      | This state of a port only occurs during the **TCP-ACK** scan and means that the port is accessible, but it cannot be determined whether it is open or closed.                                           |
| `open\|filtered`   | If we do not get a response for a specific port, `Nmap` will set it to that state. This indicates that a firewall or packet filter may protect the port.                                                |
| `closed\|filtered` | This state only occurs in the **IP ID idle** scans and indicates that it was impossible to determine if the scanned port is closed or filtered by a firewall.                








