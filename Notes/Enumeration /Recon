dirsearch -u http://<domainame>

------------------------------------------------DNS---------------------------------------------------------------------------------------------


A Records
nslookup example.com
dig facebook.com @1.1.1.1 (Server from previous query)

A Records for a Subdomain
nslookup -query=A example.com
dig a www.example.com @1.1.1.1

PTR Records for an IP Address
nslookup -query=PTR 31.13.92.36(facebook address)
dig -x 31.13.92.36 @1.1.1.1

ANY Existing Records
 nslookup -query=ANY example.com
 dig any google.com @8.8.8.8
 dig any cloudflare.com @8.8.8.8

TXT Records
 nslookup -query=TXT example.com
 dig txt facebook.com @1.1.1.1

MX Records
 nslookup -query=MX example.com
 dig mx facebook.com @1.1.1.1

 1. Identifying Nameservers
 nslookup -type=NS zonetransfer.me
 2.Perform the Zone transfer using -type=any and -query=AXFR parameters
 nslookup -type=any -query=AXFR zonetransfer.me nsztm1.digi.ninja

----------------------Passive Subdomain Enumeration--------------------




-----------------------------------------------------------Active Infrastructure Identification------------------------------


****Active Subdomain Enumeration*****


-FQDN of the nameserver for the "inlanefreight.htb" domain
 nslookup -type=NS inlanefreight.htb 10.129.223.110

1. nslookup -type=NS zonetransfer.me
Response:
Non-authoritative answer:
zonetransfer.me	nameserver = nsztm2.digi.ninja.
zonetransfer.me	nameserver = nsztm1.digi.ninja.
2.nslookup -type=any -query=AXFR zonetransfer.me nsztm1.digi.ninja

-Check number of zones:
	nslookup -type=any inlanefreight.htb 10.129.128.199
	dig ANY inlanefreight.htb @10.129.128.199

-Content of the TXT record as the answer	
dig @10.129.128.199 NS txt internal.inlanefreight.htb

-What is the FQDN of the IP address 10.10.34.136 and 10.10.1.5?
dig @10.129.128.199 NS axfr internal.inlanefreight.htb

-Using dig on “us.inlanefreight.htb” with the “NS a” filter
dig @10.129.128.199 NS a us.inlanefreight.htb

-Submit the number of all “A” records from all zones as the answer
dig @10.129.88.248 AXFR inlanefreight.htb
dig @10.129.88.248 AXFR internal.inlanefreight.htb

nslookup -type=NS inlanefreight.htb 10.129.69.22
nslookup -type=any -query=AXFR inlanefreight.htb 10.129.69.22

------------------------------------------------------------------- FFUF ----------------------------------------------------------------------------------------------------------
sudo sh -c 'echo "SERVER_IP academy.com" >> /etc/hosts'

***Directory fuzzing:
ffuf -w /opt/useful/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ
ffuf -w /opt/useful/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://SERVER_IP:PORT/FUZZ
  -t 200 = faster
  -ic  = avoid clutter results

Extension fuzzing:
ffuf -w /opt/useful/SecLists/Discovery/Web-Content/web-extensions.txt:FUZZ -u http://SERVER_IP:PORT/blog/indexFUZZ
Page fuzzing:
ffuf -w /opt/useful/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://SERVER_IP:PORT/blog/FUZZ.php

Recursive scanning:
ffuf -w /opt/useful/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://SERVER_IP:PORT/FUZZ -recursion -recursion-depth 1 -e .php -v

Subdomain:
ffuf -w /usr/share/SecLists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://FUZZ.inlanefreight.com/

VHost:
ffuf -w /opt/useful/SecLists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://academy.com:PORT/ -H 'Host: FUZZ.academy.com' -fs 986,985
curl -s http://192.168.10.10 -H "Host: randomtarget.com"
manual ffuf where you need vhost domains in the file:
cat ./vhosts | while read vhost;do echo "\n********\nFUZZING: ${vhost}\n********";curl -s -I http://192.168.10.10 -H "HOST: ${vhost}.randomtarget.com" | grep "Content-Length: ";done

Filtering:
ffuf -w /opt/useful/SecLists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://academy.com:PORT/ -H 'Host: FUZZ.academy.com' -fs 986

Parameter fuzzing - GET
ffuf -w /usr/share/SecLists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u http://admin.academy.com:PORT/admin/admin.php?FUZZ=key -fs 798

Parameter Fuzzing - POST
ffuf -w /opt/useful/SecLists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u http://admin.academy.com:PORT/admin/admin.php -X POST -d 'FUZZ=key' -H 'Content-Type: application/x-www-form-urlencoded' -fs xxx

Value Fuzzing
for i in $(seq 1 1000); do echo $i >> ids.txt; done

cat ids.txt
1
2
3
4
5
ffuf -w ids.txt:FUZZ -u http://admin.academy.com:32654/admin/admin.php -X POST -d 'id=FUZZ' -H 'Content-Type: application/x-www-form-urlencoded' -fs 768
curl -d "id=**" -H 'Content-Type: application/x-www-form-urlencoded' -X POST http://admin.academy.com:32654/admin/admin.php ->  for flag
