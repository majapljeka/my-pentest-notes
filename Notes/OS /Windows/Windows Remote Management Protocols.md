## Enumerating Windows & Fingerprinting methods
1. TTL on ICMP -  A typical response from a Windows host will either be 32 or 128 (Around 128 is the most oftern)
2. sudo nmap -v -O 192.168.86.39  ==> S CPE: cpe:/o:microsoft:windows_10 and OS details: Microsoft Windows 10 1709 - 1909 = [Nmap OS Detection](https://nmap.org/book/man-os-detection.html)
3. sudo nmap -v 192.168.86.39 --script banner.nse  ==> banner grabing - Now that we know we are dealing with a Windows 10 host, we need to enumerate the services we can see to determine if we have a potential avenue of exploitation.

## Windows Remote Management

| **Command**                                                   | **Description**                                 |
| ------------------------------------------------------------- | ----------------------------------------------- |
| `rdp-sec-check.pl <FQDN/IP>`                                  | Check the security settings of the RDP service. |
| `rdesktop -u admin -p password123 192.168.2.143`              | RDP login                                       |
| `xfreerdp /u:<user> /p:"<password>" /v:<FQDN/IP>`             | Log in to the RDP server from Linux.            |
| `evil-winrm -i <FQDN/IP> -u <user> -p <password>`             | Log in to the WinRM server.                     |
| `wmiexec.py <user>:"<password>"@<FQDN/IP> "<system command>"` | Execute command using the WMI service.          |

## Remote Desktop Protocol (RDP) (port 3389)

| **Command**                                            | **Description**                         |
| ------------------------------------------------------ | --------------------------------------- |
| `nmap -sV -sC 10.129.201.248 -p3389 --script rdp*`     | Footprint the service.           |
| `nmap -sV -sC 10.129.201.248 -p3389 --packet-trace --disable-arp-ping -n`  | In addition, we can use --packet-trace to track the individual packages and inspect their contents manually. We can see that the RDP cookies (mstshash=nmap) used by Nmap to interact with the RDP server can be identified by threat hunters and various security services such as Endpoint Detection and Response (EDR), and can lock us out as penetration testers on hardened networks.   |
| `https://github.com/CiscoCXSecurity/rdp-sec-check ; sudo cpan`     | A Perl script named rdp-sec-check.pl that can unauthentically identify the security settings of RDP servers based on the handshakes.         |
| `git clone https://github.com/CiscoCXSecurity/rdp-sec-check.git && cd rdp-sec-check; ./rdp-sec-check.pl 10.129.201.248`     | RDP Security Check.           |
| `xfreerdp /u:cry0l1t3 /p:"P455w0rd!" /v:10.129.201.248`     | Initiate an RDP Session (We can use also rdesktop or Remmina).           |


## Windows Remote Management (WinRM) (Ports 5985, 5986)

| **Command**                                            | **Description**                         |
| ------------------------------------------------------ | --------------------------------------- |
| `nmap -sV -sC 10.129.201.248 -p5985,5986 --disable-arp-ping -n`   | Footprinting the service.           |
| `evil-winrm -i 10.129.201.248 -u Cry0l1t3 -p P455w0rD!`  | If we want to find out whether one or more remote servers can be reached via WinRM, we can easily do this with the help of PowerShell. The Test-WsMan cmdlet is responsible for this.           |

## Windows Management Instrumentation (WMI) (Port 135)

| **Command**                                            | **Description**                         |
| ------------------------------------------------------ | --------------------------------------- |
| `/usr/share/doc/python3-impacket/examples/wmiexec.py Cry0l1t3:"P455w0rD!"@10.129.201.248 "hostname"`     | Footprinting the Service.           |
